<html>
<head><title>NewsCast</title></head>
<style>
	A.topics { color:white }
	.topics { color:white }
</style>

<style>
	.nickname { font-size : 8pt; font-weight : bold;  }
    .comment { font-size : 8pt}
    .title { font-weight : bold;  font-size : 10pt;}
    .description { font-size : 10pt; }
</style>

<!-- The KnowNow Library -->
<script src="/kn/?do_method=lib"></script>
<script>
<!--
var topic = (kn_argv.kn_topic ?
             kn_argv.kn_topic :
             ("/topiczero.com/news/" ));

var isRefreshNeeded=false;

var items=new Array();
var comments=new Array();

var unrecognized=0;

function doLoad()
{
    kn_subscribe(topic,this,{do_max_age : 60*60*9 });
}

function onMessage(event)
{
	if (event.type == "news")
		addItem(event);
	else
	if (event.type == "comment")
		addComment(event);
		
    refresh();
}

function findEvent(event)
{
    var item;
    for (var i=0; i < items.length; i++)
    {
        item = items[i];
        if ((event.kn_id && event.kn_id == item.kn_id) ||
            (event.link && event.link == item.link) ||
            (event.title && event.title == item.title) )
            return i;
    }
    return -1;
}

function addItem(event)
{
    var index;

    index = findEvent(event);

    if (index < 0)
    {
        items[items.length] = event;
    }
    else
    {
        items[index] = event;
    }
    isRefreshNeeded=true;
}

function addComment(event)
{
    var index;

	if (!event.nickname)
		event.nickname = "anonymous";
	comments[comments.length] = event;

    isRefreshNeeded=true;
}

function refresh()
{
    var html="";
    var item;
    var comment;

    if (!isRefreshNeeded)
        return;

	// News items
	html = "";
    for (var i=items.length-1; i >= 0 ; --i)
    {
        item = items[i];
        if (item.link && item.title)
        {
            html += "<a target='knownews_content' href='"+item.link+"'>";
            html += "<span class='title'>"+item.title+"</span></a><br />";
            html += "<span class='description'>"+item.description+"</span>";
            html += "<p />";
        }
    }
	// items
	document.all.news.innerHTML = html;
	
	// Comments
	html = "";
    for (var i=comments.length-1; i >= 0 ; --i)
    {
        comment = comments[i];
        if (comment.comment)
        {
			html += "<span class='nickname'>" + comment.nickname +  "</span>&nbsp;";
			html += "<span class='comment'>" + comment.comment +  "</span>";
            html += "<br />";
        }
    }
	// items
	document.all.comments.innerHTML = html;
	
    isRefreshNeeded=false;
}

//-->
</script>

<body onLoad='doLoad()' leftmargin='0' topmargin='0'>
<basefont face='arial' />
<table class='topics' width='100%' bgcolor='#6040a0'>
<tr><td><font size='+2' color='white'><b>NewsCast</b></font> <font size='-1'>(viewing <script>document.write(topic);</script>)</font></td>
<td align='right'>
<script>document.write("<a class='topics' target='knownews_add' href='add.html?"+topic+"'>")</script>
[Add news item]</a>
<br />
<script>document.write("<a class='topics' target='knownews_comment' href='comment.html?"+topic+"'>")</script>
[Add comment]</a>
</td></tr>
</table>
<table width='100%' bgcolor='#8060c0' >
<tr>
<td>
<a class='topics' href='.?/topiczero.com/news/'>General</a> | 
<a class='topics' href='.?/dmoz.org/News/By_Subject/Information_Technology/'>Technology</a> | 
<a class='topics' href='.?/dmoz.org/News/Breaking_News/Business_and_Economy/'>Business</a> | 
<a class='topics' href='.?/dmoz.org/Society/Future/'>Society</a> | 
<a class='topics' href='.?/dmoz.org/News/By_Subject/Information_Technology/Internet/'>Internet</a>
</td>
</tr>
</table>
<br />

<table width='100%'>
<tr valign='top'>
<td width='75%'>
<div id='news'></div>
</td>
<td>
<b>Comments</b><hr size='1' />
<div id='comments'></div>
</td>
</tr>
</table>

</body>

</html>